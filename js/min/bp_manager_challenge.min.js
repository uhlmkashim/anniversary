"use strict";

function _classCallCheck(t, e) {
    if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function")
}

function _possibleConstructorReturn(t, e) {
    if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    return !e || "object" != typeof e && "function" != typeof e ? t : e
}

function _inherits(t, e) {
    if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
    t.prototype = Object.create(e && e.prototype, {
        constructor: {
            value: t,
            enumerable: !1,
            writable: !0,
            configurable: !0
        }
    }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e)
}
var _createClass = function() {
    function t(t, e) {
        for (var n = 0; n < e.length; n++) {
            var r = e[n];
            r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r)
        }
    }
    return function(e, n, r) {
        return n && t(e.prototype, n), r && t(e, r), e
    }
}();
! function(t) {
    function e(r) {
        if (n[r]) return n[r].exports;
        var i = n[r] = {
            i: r,
            l: !1,
            exports: {}
        };
        return t[r].call(i.exports, i, i.exports, e), i.l = !0, i.exports
    }
    var n = {};
    e.m = t, e.c = n, e.d = function(t, n, r) {
        e.o(t, n) || Object.defineProperty(t, n, {
            configurable: !1,
            enumerable: !0,
            get: r
        })
    }, e.n = function(t) {
        var n = t && t.__esModule ? function() {
            return t["default"]
        } : function() {
            return t
        };
        return e.d(n, "a", n), n
    }, e.o = function(t, e) {
        return Object.prototype.hasOwnProperty.call(t, e)
    }, e.p = "", e(e.s = 0)
}([function(t, e, n) {
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var r = n(1),
        i = function(t) {
            function e() {
                return _classCallCheck(this, e), _possibleConstructorReturn(this, (e.__proto__ || Object.getPrototypeOf(e)).apply(this, arguments))
            }
            return _inherits(e, t), e
        }(r["a"]);
    window.BattlePointManagerChallenge = i
}, function(t, e, n) {
    n.d(e, "a", function() {
        return r
    });
    var r = function() {
        function t(e) {
            _classCallCheck(this, t), this.set_bp(e), this.bp_priorities = ["n", "r", "m", "f"]
        }
        return _createClass(t, [{
            key: "set_bp",
            value: function(t) {
                this.data = t
            }
        }, {
            key: "calc_bp",
            value: function(t) {
                for (var e = this, n = this.data, r = n.bp_list, i = n.bp_master.bp_usable_max, a = n.bp_flag_list.is_priority_half, o = [], s = 1; s <= i; s++) ! function(t) {
                    var e = {
                        bp: t,
                        left_bp: t,
                        bp_list: {}
                    };
                    Object.keys(r).forEach(function(t) {
                        e["bp_list"][t] = {
                            num: 0
                        }
                    }), o.push(e)
                }(s);
                var u = function(n) {
                    return t ? e.can_auto_use_full_item() ? a ? ["n", "r", "m", "f"] : ["n", "r", "f"] : ["n", "f"] : ["n", "r", "m"]
                }();
                return o.forEach(function(t) {
                    u.forEach(function(e) {
                        for (; t["left_bp"] >= 1 && r[e]["num"] - t["bp_list"][e]["num"] >= 1;) t["bp_list"][e]["num"]++, t["left_bp"] -= r[e]["effect"]
                    }), t.left_bp >= 1 ? t["color"] = "g" : e.bp_priorities.forEach(function(e) {
                        void 0 != t["bp_list"][e] && t["bp_list"][e]["num"] >= 1 && (t["color"] = e)
                    })
                }), o
            }
        }, {
            key: "can_use_full_item",
            value: function() {
                var t = this.data,
                    e = t.bp_list,
                    n = e.f,
                    r = e.n,
                    i = t.bp_master.bp_usable_max;
                return n["num"] >= 1 && r["num"] < i
            }
        }, {
            key: "can_auto_use_full_item",
            value: function() {
                var t = this.data,
                    e = t.bp_list,
                    n = (e.f, e.m),
                    r = e.r,
                    i = e.n,
                    a = t.bp_master.bp_usable_max,
                    o = t.bp_flag_list,
                    s = o.is_auto,
                    u = o.is_priority_half;
                return !!s && (u ? this.can_use_full_item() && n["num"] + i["num"] + r["num"] < a : this.can_use_full_item() && i["num"] + r["num"] < a)
            }
        }, {
            key: "draw",
            value: function(t) {
                var e = this.data,
                    n = e.bp_list,
                    r = e.bp_master.bp_name,
                    i = n.f,
                    a = this.dom,
                    o = a.$recover_btn,
                    s = a.$battle_buttons,
                    u = !1;
                t.forEach(function(t, e) {
                    var i = s.eq(e);
                    0 != i.size() && (t["bp_list"]["f"]["num"] >= 1 && (u = !0), Object.keys(n).forEach(function(e) {
                        i.find(".use_bp_" + e).val(t["bp_list"][e]["num"])
                    }), i.find("label").removeClass().addClass("button_" + r + "_" + t["color"] + "_" + (e + 1) + " jsOnDesignBtn").find("input[type=submit]").prop("disabled", "g" == t["color"]))
                }), u ? (o.addClass("selected"), o.find(".bp_item").text(i["num"] - 1).addClass("yellow")) : (o.removeClass("selected"), o.find(".bp_item").text(i["num"]).removeClass("yellow"))
            }
        }, {
            key: "setup_draw_and_action",
            value: function(t) {
                var e = this.data.bp_flag_list.is_auto,
                    n = t.$recover_btn,
                    r = this,
                    i = this.can_auto_use_full_item(),
                    a = this.calc_bp(i);
                this.dom = t, this.draw(a), e && n.addClass("autoUse"), this.can_use_full_item() || n.addClass("disabled"), n.on("click", function() {
                    return i = !i, a = r.calc_bp(i), r.draw(a), !1
                })
            }
        }]), t
    }()
}]);
